# 内存

---

## 分段和分页

### 分段

段式存储管理是一种符合用户视角的内存分配管理方案。在段式存储管理中，将程序的地址空间划分为若干段，如代码段，数据段，堆栈段。这样每个进程有一个二维地址空间，相互独立，互不干扰

### 分页

页式存储管理方案是一种用户视角内存与物理内存相分离的内存分配管理方案。在页式存储管理中，将程序的逻辑地址划分为固定大小的页，而物理内存划分为同样大小的帧，程序加载时，可以将任意一页放入内存中任意一个帧，这些帧不必连续，从而实现了离散分离

### 不同之处

#### 目的不同

分页是由于系统管理的需要而不是用户的需要，它是信息的物理单位。分段的目的是为了能更好地满足用户的需要，它是信息的逻辑单位，它含有一组其意义相对完整的信息

#### 大小不同

页的大小固定且由系统决定，而段的长度却不固定，由其所完成的功能决定

#### 地址空间不同

段向用户提供二维地址空间。页向用户提供的是一维地址空间

#### 信息共享

段是信息的逻辑单位，便于存储保护和信息的共享，页的保护和共享受到限制

#### 内存碎片

页式存储管理的优点是没有外碎片（因为页的大小固定），但会产生内碎片（一个页可能填充不满）。而段式管理的优点是没有内碎片（因为段大小可变，改变段大小来消除内碎片），但段换入换出时，会产生外碎片

---

## 虚拟内存

### 虚拟内存说明

虚拟内存允许执行进程不必完全在内存中。虚拟内存的基本思想是：每个进程拥有独立的地址空间，这个空间被分为大小相等的多个块，称为页(Page)，每个页都是一段连续的地址。这些页被映射到物理内存，但并不是所有的页都必须在内存中才能运行程序。当程序引用到一部分在物理内存中的地址空间时，由硬件立刻进行必要的映射；当程序引用到一部分不在物理内存中的地址空间时，由操作系统负责将缺失的部分装入物理内存并重新执行失败的命令。注意，请求分页系统、请求分段系统和请求段页式系统都是针对虚拟内存的，通过请求实现内存与外存的信息置换

### 页面置换算法

- FIFO先进先出算法：在操作系统中经常被用到，比如作业调度（主要实现简单，很容易想到）
- LRU（Least recently use）最近最少使用算法：根据使用时间到现在的长短来判断
- LFU（Least frequently use）最少使用次数算法：根据使用次数来判断
- OPT（Optimal replacement）最优置换算法：理论的最优，理论；就是要保证置换出去的是不再被使用的页，或者是在实际内存中最晚使用的算法

### 应用与优点

虚拟内存很适合在多道程序设计系统中使用，许多程序的片段同时保存在内存中。当一个程序等待它的一部分读入内存时，可以把CPU交给另一个进程使用。虚拟内存的使用可以带来以下好处：在内存中可以保留多个进程，系统并发度提高，解除了用户与内存之间的紧密约束，进程可以比内存的全部空间还大

---
