#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
	FILE *fp = NULL;
	char ch = ' ';
	int i = 0, j = 0, n = 0;
	int number[20][30] =
	{
		{0,0,9,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,2,0,0,0,0,0,0,0,0,0,0,0},
		{0,0,0,0,9,0,0,0,0,0,0,0,5,8,9,9,8,5,5,2,0,0,0,0,0,0,0,0,0,0},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,1,9,8,5,4,5,2,0,0,0,0,0,0,0,0,0},
		{0,0,0,0,9,0,0,0,0,0,0,0,5,8,9,9,8,5,0,4,5,2,0,0,0,0,0,0,0,0},
		{0,0,9,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,0,0,4,5,2,0,0,0,0,0,0,0},
	    {0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,1,8,5,0,0,0,4,5,2,0,0,0,0,0,0},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,1,8,5,0,0,0,0,4,5,2,0,0,0,0,0},
		{5,5,5,5,5,5,5,5,5,5,5,5,5,8,9,9,8,5,5,5,5,5,5,5,5,5,5,5,5,5},
		{8,8,8,8,8,8,8,8,8,8,8,8,5,8,9,9,8,5,8,8,8,8,8,8,8,8,8,8,8,8},
		{9,9,9,9,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,3,9,9,9,9,9,9,9},
		{8,8,8,8,8,8,8,8,8,8,8,8,5,8,9,9,8,5,8,8,8,8,8,8,8,8,8,8,8,8},
		{5,5,5,5,5,5,5,5,5,5,5,5,5,8,9,9,8,5,5,5,5,5,5,5,5,5,5,5,5,5},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,0,0,0,0,0,0,0,0,0,0,0,0},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,0,0,0,0,6,6,0,0,0,0,0,0},
		{0,0,0,0,2,2,0,0,0,0,0,0,5,8,9,9,8,5,0,0,5,6,0,0,6,5,0,0,0,0},
		{0,0,0,0,3,3,0,0,0,0,0,0,5,8,9,9,8,5,0,5,6,1,1,1,1,6,5,0,0,0},
		{0,0,0,0,4,4,0,0,0,0,0,0,5,8,9,9,8,5,0,0,5,6,0,0,6,5,0,0,0,0},
		{0,0,0,0,5,5,0,0,0,0,0,0,5,8,9,9,8,5,0,0,0,0,6,6,0,0,0,0,0,0},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,0,0,0,0,0,0,0,0,0,0,0,0},
		{0,0,0,0,0,0,0,0,0,0,0,0,5,8,9,9,8,5,0,0,0,0,0,0,0,0,0,0,0,0}
	};

	if (argc != 2)
	{
		printf("Usage : %s filename\n", argv[0]);
		exit(EXIT_FAILURE);
	}
	fopen_s(&fp, argv[1], "w+");
	if (fp == NULL)
	{
		printf("Can't open %s\n", argv[1]);
		exit(EXIT_FAILURE);
	}
	for (i = 0; i < 20; i++)
	{
		for (j = 0; j < 30; j++)
		{
			n = number[i][j];
			if (i > 0 && i < 19 && j > 0 && j < 29)
			{
				int up = 0, dn = 0, le = 0, ri = 0;
				float average = 0;

				up = n - number[i - 1][j];
				dn = n - number[i + 1][j];
				le = n - number[i][j - 1];
				ri = n - number[i][j + 1];
				average = (float)(up + dn + le + ri) / 4;
				if (up * up > 1 && dn * dn > 1 && le * le > 1 && ri * ri > 1)
				{
					if ((average - (int)average) >= 1 / 2)
						n = (int)average + 1;
					else
						n = (int)average;
				}
			}
			else
				n = 0;

			if (n == 0)
				ch = ' ';
			else if (n == 1)
				ch = '.';
			else if (n == 2)
				ch = '\'';
			else if (n == 3)
				ch = ':';
			else if (n == 4)
				ch = '~';
			else if (n == 5)
				ch = '*';
			else if (n == 6)
				ch = '=';
			else if (n == 8)
				ch = '%';
			else if (n == 9)
				ch = '#';
			
			putchar(ch);
			fprintf(fp, "%c", ch);
		}
		putchar('\n');
		fprintf(fp, "\n");
	}
	fclose(fp);

	system("pause");
	return 0;
}