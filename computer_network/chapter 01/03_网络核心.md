# 网络核心

通过网络链路和交换机移动数据有两种基本方法：`电路交换`和`分组交换`。

## 分组交换

#### 储存转发传输

大多数分组交换机采用存储转发机制来转发分组。所谓存储转发是指交换机在收到一个完成的分组，才会向链路输出转发分组，否则就将收到的部分分组缓存起来。因为缓存等待一个分组的全部数据而导致的时间开销被称为存储转发时延。

#### 排队时延与分组丢失

因为需要缓存分组，所以此时分组交换机需要一个输出缓存和输出队列。这就导致了分组不但承担了传输时延，还承担了队列时延。缓冲队列的空间有限性就有可能导致分组交换机无法继续缓存分组而使到达分组交换机的数据包被迫丢弃。

#### 转发表和路由选择协议

实际上，分组交换机之所以能够知道往哪去是因为其内部有一个转发表，这个表维护了一个IP地址和链路的对应关系，所以处理流程为：通过分组的必要信息，获得目的端系统的IP地址，通过IP地址索引转发表，从而确定输出链路。

## 电路交换

在电路交换网络中，在端系统通信会话期间，交换机会预留端系统间通信路径上的相关资源（缓存，链路传输速率），即先建立连接，然后通信。而在分组交换网络中，这些资源没有被预留。也就是说，在端系统进行通信时，其所需要的资源是被保持的，其他通信是无法使用这一部分资源的。也就说，端系统间真正建立了一条“连接”，而这一连接，用电话的术语被称为“电路”。传统的电话网络就是电路交换网络的例子。

### 电路交换网络中的复用

频分复用：将频率域划分为频段，然后将频段分配给连接；此频段被用来专门传输链接的数据。该频段的宽度成为带宽。
时分复用：是指将时间划分为固定区间的帧，每个帧则又被划分为固定数量的时间空隙。当网络需要建立一条连接时，网络将在每个帧中为该连接指定一个时隙。在该时隙内，链路用来传输该链接的数据。

对于频分复用，每条链路连续得到部分带宽。对于时分复用，每条链路周期性得到所有带宽。

### 分组交换与电路交换的对比

分组交换优点：它提供了比电路交换更好的带宽共享。它比电路交换更简单、更有效、实现成本更低。
分组交换缺点：分组交换不适合实时服务，因为端到端的时延是可变、不可预测的，这和整个网络的情况相关。

电路交换优点：提供了端对端传输数据的速率保证。
电路交换缺点：电路交换存在静默期，这是指专用电路空闲时，其占用的资源并没有得到充分的利用，建立连接的过程比较复杂。

## 网络的网络

#### 网络结构1

存在唯一的全球承载ISP互联所有的接入ISP，这是指，全球ISP是一个又路由器和通信链路构成的网络，该网络跨越全球，并且其他的接入ISP都至少和一个它的路由器相连。

#### 网络结构2

存在多个全球承载ISP，它们分别于一部分的接入ISP互联；为了实现端系统的互联，这多个全球ISP也必须互联。网络结构是一个两层结构，其中全球承载ISP位于顶层，接入ISP处于底层。

#### 网络结构3

不仅有多个竞争的ISP，每个区域中有多个竞争ISP，较小区域中的ISP连入较大区域的ISP，而不是直接与顶层ISP相连。

#### 网络结构4

在网络结构3的基础上，增加了以下特点而形成的结构：存在点、多宿、对等、因特网交换点。

#### 网络结构5

是在网络结构4的基础上增加了内容提供商网络而构成。内容提供商构建自己的网络，并且通过与较低层ISP对等而“绕过”较高层因特网ISP，而且内容提供商对端用户也有了更多的控制。
