# 路由器工作原理

## 输入端口处理和基于目的地转发

路由器用分组目的地地址的前缀与该表的表项进行匹配，如果存在匹配项，则路由器向与该匹配项相关联的链路转发分组。当有多个匹配项时，该路由器采用最长前缀匹配规则。

## 交换

### 经内存交换

在输入端口和输出端口之间的交换是在CPU的直接控制下完成。输入与输出端口的功能就像在传统操作系统中的I/O设备一样。

### 经总线交换

输入端口经一根共享总线将分组直接传送到输出端口为分组预先计划一个交换机的内部标签，指示本地输出端口，使分组在总线上传送和传输到输出端口。该分组能由所有输出端口收到，但只有与该标签匹配的端口才能保存该分组。然后该标签在输出端口被除去，因为其仅用于交换机内部来分组外所有其他分组必须等待。

### 经互联网络交换

使用互联的多个处理器的网络。纵横式交换机就是由多条总线组成的互联网络，它连接N条输入端口和N条输出端口，每条垂直的总线在交叉点与每条水平的总线交叉，交叉点通过交换结构控制器能过关在任何时候开启和闭合。

## 何时出现排队

`输入排队`和`输出排队`。
当没有足够的内存来缓存一个分组时，就必须做出决定：要么丢弃到达的分组，要么删除一个或多个已排队的分组。

## 分组调度

### 先进先出

按分组到达的顺序来依次处理分组。

### 优先权排队

优先级别高的队列中的分组优先传输，优先级别低的分组后传输。

### 循环和加权公平排队

循环取每隔队列中的第一个分组传输，若该队列为空则取下一个队列。
